@model  LanAdeptAdmin.Views.Tournaments.ModelController.TournamentModel

@{
	ViewBag.Title = "Details";
	ViewBag.Sidebar = "_Sidebar_Tournament";

	string classeEtat = "";
	string messageEtat = "";

	if (!Model.IsStarted)
	{
		classeEtat = "label-warning";
		messageEtat = "Préparation";
	}
	else if (!Model.IsOver)
	{
		classeEtat = "label-danger";
		messageEtat = "En cours";
	}
	else
	{
		classeEtat = "label-default";
		messageEtat = "Terminé";
	}
}

<h2>
	<span class="label @classeEtat">@messageEtat</span> @Html.DisplayFor(model => model.Game.Name)	
</h2>
<hr />

<div>
	<dl class="dl-horizontal">

		<dt>
			@Html.DisplayNameFor(model => model.StartTime)
		</dt>

		<dd>
			@Html.DisplayFor(model => model.StartTime)
		</dd>

		<dt>
			@Html.DisplayNameFor(model => model.MaxPlayerPerTeam)
		</dt>

		<dd>
			@Html.DisplayFor(model => model.MaxPlayerPerTeam)
		</dd>

	</dl>
	<div>
		<h4>Informations et reglements</h4>
		<p>
			@Html.Markdown(Model.Info)
		</p>
	</div>

	<h4>Teams</h4>
	<table class="table">
		<tr>
			<th>@Html.DisplayNameFor(model => model.Teams.First().Name)</th>
			<th>@Html.DisplayNameFor(model => model.Teams.First().Tag)</th>
			<th>Nombre de joueur</th>
			<th></th>
		</tr>

		@foreach (Team team in Model.Teams)
		{
			<tr @("class=clickable-row data-row-url=" + Url.Action("DetailsTeam", new { id = team.TeamID }))>
				<td>
					@if (team.IsConfirmed)
					{
						<span class="label label-success"><span class="glyphicon glyphicon-ok"></span></span>
					}
					else
					{
						<span class="label label-danger"><span class="glyphicon glyphicon-hourglass"></span></span>
					}

					@team.Name
				</td>
				<td>
					@if (team.Tag != null)
					{
						@team.Tag
					}
				</td>
				<td>
					@if (team.GamerTags.Count >= team.Tournament.MaxPlayerPerTeam)
					{
						<span class="label label-success">
							Complete
						</span>
					}
					else
					{
						<p>
							@team.GamerTags.Count / @team.Tournament.MaxPlayerPerTeam
						</p>
					}
				</td>
				<td>
					@Html.ActionLink("Delete", "Delete", new { TeamId = team.TeamID }, new { @class = "btn btn-danger" })
				</td>
			</tr>
		}
	</table>

</div>
<p>
	@Html.ActionLink("Edit", "Edit", new { id = Model.Id }, new { @class = "btn btn-default" })
	<button type="button" class="btn btn-default" data-toggle="modal" data-target="#teamList">
		Team List
	</button>
</p>


<!-- Modal -->
<div class="modal fade" id="teamList" tabindex="-1" role="dialog" aria-labelledby="myModalLabel">
	<div class="modal-dialog" role="document">
		<div class="modal-content">
			<div class="modal-header">
				<button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
				<h4 class="modal-title" id="myModalLabel">Team List</h4>
			</div>
			<div class="modal-body">
				@foreach (Team team in Model.Teams)
				{
					<p>
						@team.Name
					</p>
				}
			</div>
			<div class="modal-footer">
				<button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
			</div>
		</div>
	</div>
</div>
