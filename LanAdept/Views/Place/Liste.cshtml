@model LanAdept.Views.Place.ModelController.ListeModel

@{
	ViewBag.Title = "Liste des places";
}

@if (LanAdeptCore.Service.ReservationService.HasUserPlace())
{
	@Html.Partial("ModalChangerPlacePartial")
}
else
{
	@Html.Partial("ModalReserverPlacePartial")
}
	<div class="page-header clearfix">
		<h1 class="pull-left">Liste des places</h1>

		@if (LanAdeptCore.Service.ReservationService.HasUserPlace())
		{
			<div class="btn-toolbar pull-right">
				<div class="btn-group">
					@Html.AuthorizeActionLink("Ma place", "MaPlace", null, null, new { @class = "btn btn-success btn-header" })
				</div>
			</div>
		}

	</div>

	@if (!string.IsNullOrWhiteSpace(TempData["Error"] as string))
	{
		<div class="alert alert-danger" role="alert">
			@Html.Raw(TempData["Error"])
		</div>
	}
	@if (!string.IsNullOrWhiteSpace(TempData["Success"] as string))
	{
		<div class="alert alert-success" role="alert">
			@Html.Raw(TempData["Success"])
		</div>
	}

	@if (ViewBag.Settings.IsLanOver)
	{
		<div class="alert alert-warning" role="alert">
			Le LAN est maintenant terminé. Il n'est donc plus possible de réserver une place.
		</div>
	}
	else if (ViewBag.Settings.IsLanStarted)
	{
		<div class="alert alert-warning" role="alert">
			Le LAN a déjà débuté. Il n'est donc plus possible de réserver une place. Si vous désirez obtenir une place ou changer de place, veuillez vous rendre à l'accueil du LAN.
		</div>
	}

	@foreach (Map map in Model.Maps)
	{
		@Html.Partial("SingleMapPartial", map)
	}

<div id="legende-container">
    <div id="legende">
        <div class="row">
			<h4>Légende</h4>
            <div class="legende-col">
                <div class="place">A00</div>
            </div>
            <div class="legende-col">
                <div class="place place-reserve">A00</div>
            </div>
            <div class="legende-col">
                <div class="place place-actuelle">A00</div>
            </div>
            <div class="legende-col">
                <div class="place place-occupe">A00</div>
            </div>
        </div>
        <div class="row">
            <div class="legende-col">
                <div class="legende-label">Libre</div>
            </div>
            <div class="legende-col">
                <div class="legende-label">Réservée</div>
            </div>
            <div class="legende-col">
                <div class="legende-label">Ma place</div>
            </div>
            <div class="legende-col">
                <div class="legende-label">Occupée</div>
            </div>
        </div>
    </div>
</div>

@section scripts {
	<script>
		$('#ModalReserverPlace, #ModalChangerPlace').on('show.bs.modal', function (event) {
			var button = $(event.relatedTarget);
			var placeID = button.data('placeId');
			var text = button.data('placeText');

			var modal = $(this);
			modal.find('.modal-place-text').text(text);
			modal.find('.btnReserver').attr("href", "@Url.Action("Reserver")/" + placeID)
		})
	</script>
}

@section Styles {
	<link href="@Url.Content("~/Content/Map.css")" rel="stylesheet" type="text/css" />
}